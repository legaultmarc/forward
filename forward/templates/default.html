<!DOCTYPE html>
<html>
  <head>
    <title>Forward report</title>
    <meta charset="UTF-8">

    <!-- MathJax //-->
    <script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

    <!-- Bokeh //-->
    <link href="{{ STATIC_ROOT }}/css/bokeh-0.9.1.min.css" rel="stylesheet" type="text/css" />
    <script src="http://cdn.pydata.org/bokeh/release/bokeh-0.8.0.min.js"></script>

    <!-- jQuery //-->
    <script type="text/javascript" src="{{ STATIC_ROOT }}/bower_components/jquery/dist/jquery.min.js"></script>

    <!-- React //-->
    <script type="text/javascript" src="{{ STATIC_ROOT }}/bower_components/react/react-with-addons.js"></script>

    <!-- D3 //-->
    <script type="text/javascript" src="{{ STATIC_ROOT }}/bower_components/d3/d3.min.js"></script>

    <!-- Local imports //-->
    <link rel="stylesheet" href="{{ STATIC_ROOT }}/css/default.css" />
    <link rel="stylesheet" href="{{ STATIC_ROOT }}/css/plots.css" />
    <link rel="stylesheet" href="{{ STATIC_ROOT }}/css/pygments.css" />
    <script type="text/javascript" src="{{ STATIC_ROOT }}/js/build/react_components.js"></script>
    <script type="text/javascript" src="{{ STATIC_ROOT }}/js/build/react_rendering.js"></script>
    <script type="text/javascript" src="{{ STATIC_ROOT }}/js/build/forward_main.js"></script>
    <script type="text/javascript" src="{{ STATIC_ROOT }}/js/build/forward_plotting.js"></script>
    <script type="text/javascript" src="{{ STATIC_ROOT }}/js/build/manhattan.js"></script>
    <script type="text/javascript" src="{{ STATIC_ROOT }}/js/build/qqplot.js"></script>

    <!-- Section specific
         TODO At some point, it would be better to load them dynamically. //-->
    <script type="text/javascript" src="{{ STATIC_ROOT }}/js/build/section_glm.js"></script>

  </head>

  <body>
    <div id="wrapper">

      <div id="github"><a href="https://www.github.com/legaultmarc/forward">
        <img src="{{ STATIC_ROOT }}/img/github.png" alt="Github logo" /></a>
      </div>

      <div id="introduction">
        <h1>Introduction</h1>
        <p>This report was automatically generated by the <code>forward</code>
        utility. This tool is used to automatically execute pheWAS studies on
        epidemiologic cohorts. It uses information from biobanks as well as
        genotypic data from high throughput sequencing or genotyping platforms
        and computes different statistical analysis as requested by the
        experimentor.</p>
      </div>

      <div id="methods">
        <h2>Methods</h2>
        <p>This section should be extended by the different task objects.</p>
      </div>

      <div id="variables">
        <h2>Variables</h2>
        <p>We analyzed the following variables.</p>

        <div id="correlation-matrix"></div>

        <h3>Continuous variables</h3>
        <div id="continuous-variables-table"></div>

        <h3>Discrete variables</h3>
        <div id="discrete-variables-table"></div>
        <div id="variable-modal"></div>

        <div id="related-exclusions">
          <h3>Related outcomes</h3>
          <p>For discrete outcomes, it is important to account for the possible
          relationship between phenotypes. When assigning case-control status,
          it is best to excludes samples that are affected with a correlated
          and thus potentially functionally related phenotype from controls.
          This additional quality control step helps reduce the probability of
          including an latent case in the control group.</p>
          <p>In this experiment, outcomes that had an absolute correlation
          coefficient above <span class="fwdinfo phenotype_correlation_for_exclusion"></span> 
          were considered to be related and the affected individuals were
          discarded from the relevant analyses. A summary of the relevant 
          exclusions is available in Table X.</p>

          <div id="related-exclusions-table"></div>
        </div>


      </div>

      <div id="results">
        <h3>Results</h3>

        <!--
            Dynamically check the tasks and render them as sections in the
            results.
            This will work by including html snippets corresponding to the
            different task names. It won't be a REST api because of the need
            for text formatting.
        //-->
        <script type="text/javascript">
          // Get the tasks.
          $.getJSON(window.location.pathname + "/experiment/tasks.json", function(data) {
            var tasks = data.tasks;
            // For every task, fetch the html snippet.
            tasks.map(function(task) {
              forward.handleTask(task.type, task.name);
            });
          });
        </script>

      </div>

      <div id="figures">
        <h3>Figures</h3>
      </div>

      <div id="annex">
        <h3>Annex</h3>

        <div id="variant-table"></div>

      </div>

    </div> <!-- /wrapper //-->

    <div id="footer"><p>Experiment started on <span class="fwdinfo start_time"></span></p></div>

  </body>

</html>
